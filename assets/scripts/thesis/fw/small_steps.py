import numpy as np
import matplotlib.pyplot as plt
import math
from scipy.interpolate import UnivariateSpline

# --- Données ---
# (Gardées à l'identique de votre code)
error = [
     [ #P1
          [3.8, 0.53, 0.1, 0.028, 0.0092, 0.0037, 0.0015, 0.00072, 0.00036, 0.00017, 7.5e-05, 6.4e-05, 5.0e-05],
          [3.4, 0.46, 0.088, 0.024, 0.0077, 0.003, 0.0012, 0.00059, 0.00029, 0.00013, 5.6e-05, 5.1e-05, 4.3e-05], 
          [3.15, 0.4, 0.074, 0.019, 0.0062, 0.0024, 0.00095, 0.00044, 0.00022, 0.0001, 4.2e-05] 
     ],#Q1
     [
          [9.40e-03, 2.90e-03, 1.10e-03, 4.00e-04, 1.90e-04, 9.50e-05, 3.70e-05],
          [2.00e+00, 1.90e-01, 3.00e-02, 7.50e-03, 2.20e-03, 8.00e-04, 2.90e-04, 1.40e-04, 6.90e-05, 2.50e-05],
          [1.98e+00, 1.90e-01, 3.20e-02, 7.70e-03, 2.30e-03, 8.30e-04, 3.10e-04, 1.50e-04, 7.30e-05, 2.70e-05],
          [1.60e+00, 1.20e-01, 1.90e-02, 4.30e-03, 1.30e-03, 3.80e-04, 1.30e-04, 6.00e-05, 2.80e-05]
     ],
     [#P2    
          [1.70e-01, 4.80e-02, 1.70e-02, 7.20e-03, 3.10e-03, 1.60e-03, 8.40e-04, 4.30e-04, 2.10e-04, 1.60e-04, 1.20e-04, 4.30e-05],
          [4.20e+00, 7.30e-01, 1.60e-01, 4.40e-02, 1.50e-02, 6.40e-03, 2.80e-03, 1.40e-03, 7.20e-04, 3.70e-04, 1.80e-04, 1.30e-04, 9e-05, 4.40e-05],
          [4.20e+00, 6.90e-01, 1.40e-01, 4.00e-02, 1.40e-02, 5.70e-03, 2.50e-03, 1.20e-03, 6.20e-04, 3.10e-04, 1.40e-04, 1.10e-04, 8.70e-05, 2.60e-05],
          [3.90e+00, 6.00e-01, 1.20e-01, 3.30e-02, 1.10e-02, 4.50e-03, 1.90e-03, 9.20e-04, 4.70e-04, 2.20e-04, 9.80e-05, 7.70e-05, 6.20e-05, 1.50e-05]
     ],
     [#Q2    
          [3.60e+00, 5.10e-01, 1.00e-01, 2.90e-02, 1.00e-02, 4.20e-03, 1.80e-03, 9.60e-04, 6.00e-04, 4.10e-04, 2.20e-04, 1.00e-04, 8.40e-05, 2.70e-05],
          [3.50e+00, 5.00e-01, 9.70e-02, 2.70e-02, 9.40e-03, 3.80e-03, 1.70e-03, 8.60e-04, 4.60e-04, 2.30e-04, 1.10e-04, 8.90e-05, 7.50e-05, 2.20e-05],
          [3.50e+00, 4.70e-01, 9.10e-02, 2.50e-02, 8.70e-03, 3.60e-03, 1.60e-03, 7.90e-04, 4.10e-04, 2.10e-04, 9.70e-05, 8.00e-05, 6.70e-05, 1.90e-05],
          [3.30e+00, 4.40e-01, 8.30e-02, 2.30e-02, 7.70e-03, 3.10e-03, 1.30e-03, 6.70e-04, 3.50e-04, 1.70e-04, 7.70e-05, 6.60e-05, 5.0e-05]
     ]
]

time = [
     [
          [0.42, 0.90, 1.30, 1.70, 2.00, 2.60, 2.90, 3.30, 3.60, 4.00, 4.40, 5.00, 5.30],
          [0.52, 1.10, 1.60, 2.20, 2.70, 3.30, 4.00, 4.30, 4.80, 5.20, 5.80, 6.50, 6.90], 
          [0.49, 0.90, 1.50, 1.80, 2.30, 2.90, 3.30, 3.80, 4.10, 4.60, 5.20]
     ] ,
     [
          [2.10, 2.50, 3.00, 3.40, 3.80, 4.30, 4.90],
          [0.60, 1.20, 1.70, 2.30, 2.90, 3.40, 3.90, 4.50, 5.20, 5.70],
          [0.65, 1.50, 2.10, 2.60, 3.30, 3.90, 4.50, 5.10, 5.60, 6.20],
          [0.85, 1.65, 2.50, 3.10, 3.90, 4.60, 5.50, 6.20, 7.00]
     ],
     [
          [1.80, 2.50, 3.00, 3.70, 4.20, 4.90, 5.70, 6.20, 6.8, 7.4, 8.00, 8.70],
          [0.75, 1.50, 2.20, 3.10, 3.70, 4.60, 5.30, 6.00, 6.70, 7.80, 8.50, 9.00, 9.60, 10.00],
          [0.78, 1.60, 2.30, 3.20, 4.10, 4.80, 5.50, 6.10, 7.10, 7.60, 8.40, 9.20, 10.00, 10.60],
          [1.10, 2.30, 3.20, 4.20, 5.40, 6.50, 7.30, 8.30, 9.40, 10.60, 11.50, 12.80, 13.50, 14.60]
     ],
     [
          [1.00, 1.90, 2.90, 3.80, 4.80, 5.70, 6.70, 7.70, 8.60, 9.50, 10.4, 11.4, 12.40, 13.20],
          [1.20, 2.40, 3.60, 4.80, 6.00, 7.10, 8.30, 9.30, 10.60, 11.80, 12.80, 14.40, 16.90, 19.40],
          [1.40, 2.80, 4.10, 5.60, 7.00, 8.10, 10.00, 11.10, 12.40, 13.90, 15.10, 16.90, 19.00, 21.30],
          [2.20, 4.40, 6.60, 8.80, 11.30, 13.10, 15.80, 17.50, 20.60, 23.00, 25.00, 27.50, 29.00]
     ]
]

fig, axes = plt.subplots(2, 2, figsize=(12, 8))
labels = [ 
     [r"$C_{max} = 2$",r"$C_{max} = 3$",r"$C = 4$"],
     [r"$C_{max} = 2$",r"$C_{max} = 3$",r"$C_{max}$ = 4",r"$C = 8$"],
     [r"$C_{max} = 3$",r"$C_{max} = 4$",r"$C_{max}$ = 5",r"$C = 10$"],
     [r"$C_{max} = 4$",r"$C_{max} = 6$",r"$C_{max}$ = 8",r"$C = 27$"],
]
colors = ["#2c3e50", "#3498db","#9b59b6", "#e67e22"]
markers = ["o", "o", "o", "o"] # Ajout de marqueurs (rond, carré, losange, triangle)

titles = [r"P1", r"Q1", r"P2", r"Q2"]

for i in range(len(error)):
     b = i % 2
     a = i // 2
     if(i == 2 or i == 3):
          axes[a][b].set_xlabel('coût (ms)', fontfamily="Times New Roman", fontsize=20)
     if(i == 0 or i == 2):
          axes[a][b].set_ylabel('erreur', fontfamily="Times New Roman", fontsize=20)
     axes[a][b].set_yscale("log")
     axes[a][b].set_title("Convergence " + titles[i], fontsize=18)
     axes[a][b].axhline(5e-5, color='#e74c3c', linestyle='--', alpha=1)
     axes[a][b].tick_params(axis='x', labelsize=14) 
     axes[a][b].tick_params(axis='y', labelsize=14) 
     for k in range(len(error[i])):
          j = len(error[i]) - k - 1
          x = np.array(time[i][j])
          y = np.array(error[i][j])

          # Ajout de marker=markers[k] et markersize=5
          axes[a][b].plot(x, y, color=colors[k], marker=markers[k], 
                          markersize=5, label=labels[i][j], linewidth=1.5)
     
          axes[a][b].legend(fontsize=16)

plt.tight_layout()
plt.savefig("VBD_Convergence_color.png", dpi=300)
plt.show()
